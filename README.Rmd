---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# survTrial

The goal of survTrial is to document simulation methods used within Bayer Medical Statistics Oncology.  The current version of the package runs simulation scenarios for PFS, allowing for either:

* event times (progression and death) simulated from exponential distribution.
* death times simulated from exponential distribution, but progression times are moved forward to next   
  scheduled time and censored times are moved back to previous visit after random generation from   
  exponential.
  
Summary statistics for Kaplan-Meier medians and associated simulation graphs can be displayed for two treatment groups.  Similarly, simulation results for hazard ratio over all iterations of the trial design can be extracted.

## Installation

You can install the latest version of survTrial from [GitHub](https://github.com/) with:

``` {r, eval = FALSE}
# install.packages("devtools")
devtools::install_github("reevesj53/survTrial")
```
## Example
```{r}
library(survTrial)
```
The code below shows examples of output from the simulations.

First, generate an example enrollment schedule, with ramp-up period of 5 months, 10 subjects per month thereafter leading to a total of 60 subjects with 1:1 randomization.

The visit schedule for tumor assessments is every 4 weeks.  Median PFS for the two treatment groups (Sip-T and Placebo) are 12 and 10 months respectively.

Data cut-off will occur at the 40th event.
```{r example}
enrol <- c(seq(2,10,length.out=5),rep(10,times=3))
schedule <- seq(0,100,4)
rxrate <- c(12,10)
nevent <- 40

```
Then run the simulation:
```{r sim}
sim <- trial_sim(schedule, enrol, rxrate, nevent, adjust=TRUE, trt=c("Sip-T","placebo"),death.prop=0.1,
censor.prop=0.1,n.rep=1000)
```

```{r calc_km}
sim.km <- calc_km(sim)
sim.km
```
Next plot results
```{r plot1}
plot_sim(sim.km)
```
Or add confidence bounds and summary table to plot.
```{r plot2}
plot_sim(sim.km, ci=TRUE, summary=TRUE)
```
